<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attacks &mdash; GRAIMATTER 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Base Class" href="safemodel.html" />
    <link rel="prev" title="Preprocessing" href="preprocessing.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> GRAIMATTER
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="safemodel.html">Base Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="safedecisiontree.html">SafeDecisionTree</a></li>
<li class="toctree-l1"><a class="reference internal" href="saferandomforest.html">SafeRandomForest</a></li>
<li class="toctree-l1"><a class="reference internal" href="safekeras.html">SafeKerasModel</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GRAIMATTER</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Attacks</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/attacks.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-attacks.metrics">
<span id="attacks"></span><h1>Attacks<a class="headerlink" href="#module-attacks.metrics" title="Permalink to this heading"></a></h1>
<p>Calculate metrics.</p>
<dl class="py function">
<dt class="sig sig-object py" id="attacks.metrics.div">
<span class="sig-prename descclassname"><span class="pre">attacks.metrics.</span></span><span class="sig-name descname"><span class="pre">div</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/attacks/metrics.html#div"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#attacks.metrics.div" title="Permalink to this definition"></a></dt>
<dd><p>Solve the problem of division by 0 and round up.
If y is non-zero, perform x/y and round to 8dp. If it is zero, return the default</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x: float</strong></dt><dd><p>numerator</p>
</dd>
<dt><strong>y: float</strong></dt><dd><p>denominator</p>
</dd>
<dt><strong>default: float</strong></dt><dd><p>return value if y == 0</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>division: float</dt><dd><p>x / y, or default if y == 0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="attacks.metrics.expected_auc_var">
<span class="sig-prename descclassname"><span class="pre">attacks.metrics.</span></span><span class="sig-name descname"><span class="pre">expected_auc_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/attacks/metrics.html#expected_auc_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#attacks.metrics.expected_auc_var" title="Permalink to this definition"></a></dt>
<dd><p>“Compute variance of AUC under assumption of uniform probabilities
uses the expression given as eqn (2) in  <a class="reference external" href="https://cs.nyu.edu/~mohri/pub/area.pdf">https://cs.nyu.edu/~mohri/pub/area.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>auc: float</strong></dt><dd><p>auc value at which to compute the variance</p>
</dd>
<dt><strong>num_pos: int</strong></dt><dd><p>number of positive examples</p>
</dd>
<dt><strong>num_neg: int</strong></dt><dd><p>number of negative examples</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>var: float</dt><dd><p>null variance of AUC</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="attacks.metrics.get_metrics">
<span class="sig-prename descclassname"><span class="pre">attacks.metrics.</span></span><span class="sig-name descname"><span class="pre">get_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">permute_rows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/attacks/metrics.html#get_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#attacks.metrics.get_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Calculate metrics, including attacker advantage for MIA binary.
Implemented as Definition 4 on <a class="reference external" href="https://arxiv.org/pdf/1709.01604.pdf">https://arxiv.org/pdf/1709.01604.pdf</a>
which is also implemented in tensorFlow-privacy <a class="reference external" href="https://github.com/tensorflow/privacy">https://github.com/tensorflow/privacy</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>clf: sklearn.Model</strong></dt><dd><p>trained model</p>
</dd>
<dt><strong>X_test: np.ndarray</strong></dt><dd><p>test data matrix</p>
</dd>
<dt><strong>y_test: np.ndarray</strong></dt><dd><p>test data labels</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>metrics: dict</dt><dd><p>dictionary of metric values</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Includes the following metrics</p>
<p>True positive rate or recall (TPR)
False positive rate (FPR), proportion of negative examples incorrectly classified as positives
False alarm rate (FAR), proportion of objects classified as positives that are incorrect,</p>
<blockquote>
<div><p>also known as false discovery rate</p>
</div></blockquote>
<p>True neagative rate (TNR)
Positive predictive value or precision (PPV)
Negative predictive value (NPV)
False neagative rate (FNR)
Accuracy (ACC)
F1 Score - harmonic mean of precision and recall.
Advantage</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="attacks.metrics.tpr_at_fpr">
<span class="sig-prename descclassname"><span class="pre">attacks.metrics.</span></span><span class="sig-name descname"><span class="pre">tpr_at_fpr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_score</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fpr_perc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/attacks/metrics.html#tpr_at_fpr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#attacks.metrics.tpr_at_fpr" title="Permalink to this definition"></a></dt>
<dd><p>Compute the TPR at a fixed FPR.
In particular, returns the TPR value corresponding to a particular FPR. Uses interpolation
to fill in gaps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>y_true: Iterable[float]</strong></dt><dd><p>actual class labels</p>
</dd>
<dt><strong>y_score: Iterable[float]</strong></dt><dd><p>predicted score</p>
</dd>
<dt><strong>fpr: float</strong></dt><dd><p>false positive rate at which to compute true positive rate</p>
</dd>
<dt><strong>fpr_perc: bool</strong></dt><dd><p>if the fpr is defined as a percentage</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>tpr: float</dt><dd><p>true positive rate at fpr</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-attacks.mia_extremecase"></span><p>Method for computing extreme case metrics</p>
<dl class="py function">
<dt class="sig sig-object py" id="attacks.mia_extremecase.min_max_disc">
<span class="sig-prename descclassname"><span class="pre">attacks.mia_extremecase.</span></span><span class="sig-name descname"><span class="pre">min_max_disc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_probs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_prop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/attacks/mia_extremecase.html#min_max_disc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#attacks.mia_extremecase.min_max_disc" title="Permalink to this definition"></a></dt>
<dd><p>Non-average-case methods for MIA attacks. Considers actual frequency of membership
amongst samples with highest- and lowest- assessed probability of membership. If an
MIA method confidently asserts that 5% of samples are members and 5% of samples are
not, but cannot tell for the remaining 90% of samples, then these metrics will flag
this behaviour, but AUC/advantage may not. Since the difference may be noisy, a
p-value against a null of independence of true membership and assessed membership
probability (that is, membership probabilities are essentially random) is also used
as a metric (using a usual Gaussian approximation to binomial). If the p-value is
low and the frequency difference is high (&gt;0.5) then the MIA attack is successful
for some samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>y: np.ndarray</strong></dt><dd><p>true labels</p>
</dd>
<dt><strong>yp: np.ndarray</strong></dt><dd><p>probabilities of labels, or monotonic transformation of probabilties</p>
</dd>
<dt><strong>xprop: float</strong></dt><dd><p>proportion of samples with highest- and lowest- probability of membership to be
considered</p>
</dd>
<dt><strong>logp: bool</strong></dt><dd><p>convert p-values to log(p).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>maxd: float</dt><dd><p>frequency of y=1 amongst proportion xprop of individuals with highest assessed
membership probability</p>
</dd>
<dt>mind: float</dt><dd><p>frequency of y=1 amongst proportion xprop of individuals with lowest assessed
membership probability</p>
</dd>
<dt>mmd: float</dt><dd><p>difference between maxd and mind</p>
</dd>
<dt>pval: float</dt><dd><p>p-value or log-p value corresponding to mmd against null hypothesis that random
variables corresponding to y and yp are independent.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maxd</span><span class="p">,</span> <span class="n">mind</span><span class="p">,</span> <span class="n">mmd</span><span class="p">,</span> <span class="n">pval</span> <span class="o">=</span> <span class="n">min_max_desc</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">yp</span><span class="p">,</span> <span class="n">xprop</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">logp</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="preprocessing.html" class="btn btn-neutral float-left" title="Preprocessing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="safemodel.html" class="btn btn-neutral float-right" title="Base Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, GRAIMATTER Project Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>